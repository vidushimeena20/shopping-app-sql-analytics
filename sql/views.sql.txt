CREATE VIEW customer_purchase_summary AS
SELECT c.customer_id, c.name,
COUNT(o.order_id) AS total_orders,
SUM(p.amount) AS total_spent
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
LEFT JOIN payments p ON o.order_id = p.order_id
WHERE p.status='Success'
GROUP BY c.customer_id, c.name;